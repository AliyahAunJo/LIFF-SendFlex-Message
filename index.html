<html>
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=0,viewport-fit=cover"
    />
    <title>LINE SEND MESSAGE By KruAun Jaidee</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
  
    <style>
      body {
        box-sizing: border-box;
        border: 1px solid;
        margin: 30px 30px;
        background-color: rgb(9, 9, 9);
        box-decoration-break: unset;
        display: flex;
        align-items: center;
        justify-content: center;
        background-color: black;
        overflow: hidden;
      }
      textarea {
        border-radius: 5px;
        box-shadow: 1px 1px 10px 0.5px grey;
      }
      #label1 {
        margin-left: -235px;
      }
      #label2 {
        margin-left: -190px;
      }

      #loader {
        width: 10em;
        height: 10em;
        font-size: 25px;
        box-sizing: border-box;
        border-top: 0.3em solid hotpink;
        border-radius: 50%;
        position: relative;
        animation: rotating 2s ease-in-out infinite;
        --direction: 1;
      }

      #loader::before,
      #loader::after {
        content: "";
        position: absolute;
        width: inherit;
        height: inherit;
        border-radius: 50%;
        box-sizing: border-box;
        top: -0.2em;
      }

      #loader::before {
        border-top: 0.3em solid dodgerblue;
        transform: rotate(120deg);
      }

      #loader::after {
        border-top: 0.3em solid gold;
        transform: rotate(240deg);
      }

      #loader span {
        position: absolute;
        color: white;
        width: inherit;
        height: inherit;
        text-align: center;
        line-height: 10em;
        font-family: sans-serif;
        animation: rotating 2s linear infinite;
        --direction: -1;
      }

      @keyframes rotating {
        50% {
          transform: rotate(calc(180deg * var(--direction)));
        }

        100% {
          transform: rotate(calc(360deg * var(--direction)));
        }
      }
    </style>

    <link rel="stylesheet" href="flex2html.css" />
    <scrip type="text/javascript" src="flex2html.min.js"></script>
  </head>
  <body onload="hideLoader()">
    <div id="loader">
      <span>Loading...</span>
    </div>
    <div style="display: none" id="myDiv" class="animate-bottom">
      <div class="container text-center">
        <img
          id="pictureUrl"
          class="img-circle mb-2 mt-3"
          alt="Cinque Terre"
          width="50"
          height="50"
        />
        <p class="text-white mb-2" id="userId"></p>
        <center><p class="text-white mb-2" id="displayName"></p></center>
        <p class="text-white mb-2" id="statusMessage"></p>
        <p class="text-white mb-2" id="getDecodedIDToken"></p>
        <h2 class="mt-3 text-white">❤️ สร้าง Flex Message ❤️</h2>
        <button class="btn btn-success mb-3 text-white" onclick="goSimulator()">
          ไปที่ Flex Simulator
        </button>
        <br />
        <label id="label1" class="text-white mb-3" for="">Alt text</label>
        <input class="form-control mb-3" type="text" name="" id="alt" />
        <label id="label2" class="text-white mb-3" for=""> Flex Message</label>
        <textarea
          class="form-control"
          id="myTextarea"
          rows="15"
          cols="25"
        ></textarea>

        <p class="mt-3 text-white">กดปุ่มเพื่อส่ง Flex ไปหาเพื่อนของคุณ</p>

        <button class="btn btn-danger" type="button" onclick="myFunction()">
          ส่ง Flex ทันที
        </button>

        <p class="mt-5 text-white" id="demo"></p>
        <hr class="text-white" />
        <p class="text-white">❤️ พัฒนาโดย ครูอั๋นใจดี ❤️</p>
      </div>
    </div>

    <div class="chatbox">
      <div id="flex1"></div>
    </div>

    <script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
    <script>
      function hideLoader() {
        setTimeout(showPage, 3000);
      }
      function showPage() {
        document.getElementById("loader").style.display = "none";
        document.getElementById("myDiv").style.display = "block";
      }

      function runApp() {
        liff
          .getProfile()
          .then((profile) => {
            document.getElementById("pictureUrl").src = profile.pictureUrl; // %u0E41%u0E2A%u0E14%u0E07%u0E23%u0E39%u0E1B Profile %u0E17%u0E35%u0E48%u0E14%u0E36%u0E07%u0E21%u0E32
            document.getElementById("userId").innerHTML =
              "<b>UserId:</b><br/> " + profile.userId;
            document.getElementById("displayName").innerHTML =
              "<b>สวัสดี:</b><br/> " + profile.displayName; // %u0E41%u0E2A%u0E14%u0E07%u0E0A%u0E37%u0E48%u0E2D Line %u0E02%u0E2D%u0E07%u0E1C%u0E39%u0E49%u0E43%u0E0A%u0E49
            document.getElementById("statusMessage").innerHTML =
              "<b>StatusMessage:</b></br> " + profile.statusMessage; // %u0E41%u0E2A%u0E14%u0E07%u0E2A%u0E16%u0E32%u0E19%u0E30%u0E02%u0E2D%u0E07%u0E1C%u0E39%u0E49%u0E43%u0E0A%u0E49 Line
            //document.getElementById("getDecodedIDToken").innerHTML = '<b>Email:</b> ' + liff.getDecodedIDToken().email;
          })
          .catch((err) => console.error(err));
      }
      liff.init(
        { liffId: "2000534426-2E3BdkoV" },
        () => {
          if (liff.isLoggedIn()) {
            runApp();
          } else {
            liff.login();
          }
        },
        (err) => console.error(err.code, error.message)
      );

      // logout
      const accessToken = liff.getAccessToken();
      if (accessToken) {
        fetch("https://api...", {
          headers: {
            "Content-Type": "application/json",
            Authorization: `Bearer ${accessToken}`,
          },
          //...
        });
      }

      function myFunction() {
        var altText = document.getElementById("alt").value;
        var message = document.getElementById("myTextarea").value;
        // document.getElementById("demo").innerHTML = message;

        liff.init({ liffId: "2000534426-2E3BdkoV" });
        // liff.id equals to liffId
        liff.ready.then(() => {
          liff
            .sendMessages([
              {
                type: "flex",
                altText: altText,
                contents: JSON.parse(message),
              },
            ])
            .then(() => {
              Swal.fire({
                position: "center",
                icon: "success",
                title: "ส่ง Flex เรียบร้อย !",
                showConfirmButton: false,
                timer: 1500,
              });
              document.getElementById("alt").value = "";
              document.getElementById("myTextarea").value = "";

              console.log("message sent");
            })
            .catch((err) => {
              console.log("error", err);
            });
        });
      }
      //จบฟังก์ชั่น
      function goSimulator() {
        liff.openWindow({
          url: "https://developers.line.biz/flex-simulator/",
          external: true,
        });
      }

      flex2html("flex1", {
        type: "flex",
        altText: "Flex Message",
        contents: {
          type: "bubble",
          hero: {
            type: "video",
            url: "https://firebasestorage.googleapis.com/v0/b/betask-linked/o/video%2FMotion-L_BeLink_Draft2.mp4?alt=media&token=8ab07860-7e66-4758-a47f-277aed20730d",
            previewUrl:
              "https://firebasestorage.googleapis.com/v0/b/betask-linked/o/video%2FScreen%20Shot%202566-06-16%20at%2009.40.03.png?alt=media&token=320e7e5b-dd27-46ee-875c-d0f18ca6c8ea",
            altContent: {
              type: "image",
              size: "full",
              aspectRatio: "20:13",
              aspectMode: "cover",
              url: "https://firebasestorage.googleapis.com/v0/b/betask-linked/o/video%2FScreen%20Shot%202566-06-16%20at%2009.40.03.png?alt=media&token=320e7e5b-dd27-46ee-875c-d0f18ca6c8ea",
            },
          },
          body: {
            type: "box",
            layout: "vertical",
            contents: [
              {
                type: "box",
                layout: "vertical",
                contents: [
                  {
                    type: "text",
                    text: "Be Linked",
                    weight: "bold",
                    size: "xl",
                    color: "#1B437C",
                  },
                  { type: "text", text: "ระบบจองคิวผ่าน LINE OA" },
                  { type: "text", text: "ครอบคลุมทุกธุรกิจ" },
                ],
                paddingStart: "30px",
                paddingTop: "20px",
              },
              {
                type: "box",
                layout: "vertical",
                margin: "xl",
                spacing: "lg",
                contents: [
                  {
                    type: "box",
                    layout: "horizontal",
                    spacing: "none",
                    contents: [
                      {
                        type: "image",
                        url: "https://firebasestorage.googleapis.com/v0/b/betask-linked/o/video%2F_Group_%20(4).png?alt=media&token=d8950d64-4b71-4a5c-8a60-8ba9850f8aef",
                        margin: "none",
                        gravity: "center",
                      },
                      {
                        type: "text",
                        text: "จองคิวนัดหมาย",
                        wrap: true,
                        color: "#666666",
                        size: "md",
                        flex: 5,
                        gravity: "center",
                        margin: "xl",
                      },
                    ],
                    backgroundColor: "#eeeeee",
                    paddingStart: "20px",
                    margin: "none",
                    height: "50px",
                  },
                ],
              },
              {
                type: "box",
                layout: "vertical",
                margin: "xs",
                spacing: "lg",
                contents: [
                  {
                    type: "box",
                    layout: "horizontal",
                    spacing: "none",
                    contents: [
                      {
                        type: "image",
                        url: "https://firebasestorage.googleapis.com/v0/b/betask-linked/o/video%2F_Group_%20(5).png?alt=media&token=8640a1ad-989d-47a9-a3a5-a73560ef74a6",
                        margin: "none",
                        gravity: "center",
                      },
                      {
                        type: "text",
                        text: "นัดหมาย นอกสถานที่ (Onsite)",
                        wrap: true,
                        color: "#666666",
                        size: "md",
                        flex: 5,
                        gravity: "center",
                        margin: "xl",
                      },
                    ],
                    backgroundColor: "#eeeeee",
                    paddingStart: "20px",
                    margin: "none",
                    height: "50px",
                  },
                ],
              },
              {
                type: "box",
                layout: "vertical",
                margin: "xs",
                spacing: "lg",
                contents: [
                  {
                    type: "box",
                    layout: "horizontal",
                    spacing: "none",
                    contents: [
                      {
                        type: "image",
                        url: "https://firebasestorage.googleapis.com/v0/b/betask-linked/o/video%2F_Group_%20(6).png?alt=media&token=f88306db-460b-449f-90a6-6824e03da14d",
                        margin: "none",
                        gravity: "center",
                      },
                      {
                        type: "text",
                        text: "ระบบบัตรคิว หน้าร้าน",
                        wrap: true,
                        color: "#666666",
                        size: "md",
                        flex: 5,
                        gravity: "center",
                        margin: "xl",
                      },
                    ],
                    backgroundColor: "#eeeeee",
                    paddingStart: "20px",
                    margin: "none",
                    height: "50px",
                  },
                ],
              },
              {
                type: "box",
                layout: "vertical",
                margin: "md",
                spacing: "none",
                contents: [{ type: "separator" }],
              },
            ],
            paddingAll: "0px",
          },
          footer: {
            type: "box",
            layout: "vertical",
            spacing: "none",
            contents: [
              {
                type: "button",
                style: "link",
                height: "sm",
                action: {
                  type: "uri",
                  label: "WEBSITE",
                  uri: "https://betaskthai.com/",
                },
                color: "#ffffff",
              },
              { type: "box", layout: "vertical", contents: [], margin: "sm" },
            ],
            flex: 0,
            backgroundColor: "#1B437C",
            margin: "none",
          },
        },
      });
    </script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
   <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"></script>
  </body>
</html>
